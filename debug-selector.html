<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>选择器调试页面</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/antd@5.26.5/dist/reset.css">
    <link rel="stylesheet" href="https://unpkg.com/antd@5.26.5/dist/antd.css">
    <script src="https://unpkg.com/antd@5.26.5/dist/antd.js"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px;
        }
        
        .debug-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }
        
        .debug-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 2px solid #f0f0f0;
            border-radius: 8px;
        }
        
        .debug-title {
            color: #667eea;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .test-result {
            margin-top: 12px;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .test-success {
            background: #f6ffed;
            border: 1px solid #b7eb8f;
            color: #52c41a;
        }
        
        .test-error {
            background: #fff2f0;
            border: 1px solid #ffccc7;
            color: #ff4d4f;
        }
        
        .level-selector {
            width: 100%;
            height: 50px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Select, Button, Card, Space, Typography, Row, Col } = antd;
        const { Title, Text } = Typography;
        const { Option } = Select;

        function DebugApp() {
            const [englishLevel, setEnglishLevel] = useState('');
            const [testResults, setTestResults] = useState([]);
            const [isDropdownOpen, setIsDropdownOpen] = useState(false);

            const levelOptions = [
                { value: 'CET-4', label: '🎯 英语四级 (CET-4)', description: '基础词汇与语法' },
                { value: 'CET-6', label: '🚀 英语六级 (CET-6)', description: '进阶词汇与表达' },
                { value: 'IELTS', label: '🌍 雅思 (IELTS)', description: '国际英语水平' },
                { value: 'TOEFL', label: '🎓 托福 (TOEFL)', description: '学术英语能力' }
            ];

            const addTestResult = (result) => {
                setTestResults(prev => [...prev, {
                    time: new Date().toLocaleTimeString(),
                    ...result
                }]);
            };

            const runTests = () => {
                setTestResults([]);
                
                // 测试1：选择器是否存在
                try {
                    const selector = document.querySelector('.ant-select');
                    if (selector) {
                        addTestResult({
                            test: '选择器DOM元素存在',
                            status: 'success',
                            details: '✅ 找到了.ant-select元素'
                        });
                    } else {
                        addTestResult({
                            test: '选择器DOM元素存在',
                            status: 'error',
                            details: '❌ 未找到.ant-select元素'
                        });
                    }
                } catch (e) {
                    addTestResult({
                        test: '选择器DOM元素存在',
                        status: 'error',
                        details: `❌ 错误: ${e.message}`
                    });
                }

                // 测试2：CSS样式检查
                setTimeout(() => {
                    try {
                        const selector = document.querySelector('.ant-select');
                        const styles = window.getComputedStyle(selector);
                        addTestResult({
                            test: 'CSS样式检查',
                            status: 'success',
                            details: `✅ display: ${styles.display}, visibility: ${styles.visibility}, z-index: ${styles.zIndex}`
                        });
                    } catch (e) {
                        addTestResult({
                            test: 'CSS样式检查',
                            status: 'error',
                            details: `❌ 错误: ${e.message}`
                        });
                    }
                }, 100);

                // 测试3：点击事件检查
                setTimeout(() => {
                    try {
                        const selector = document.querySelector('.ant-select-selector');
                        if (selector) {
                            selector.click();
                            
                            setTimeout(() => {
                                const dropdown = document.querySelector('.ant-select-dropdown');
                                if (dropdown && !dropdown.hidden) {
                                    addTestResult({
                                        test: '下拉框显示测试',
                                        status: 'success',
                                        details: '✅ 点击后下拉框正常显示'
                                    });
                                } else {
                                    addTestResult({
                                        test: '下拉框显示测试',
                                        status: 'error',
                                        details: '❌ 点击后下拉框未显示'
                                    });
                                }
                            }, 500);
                        }
                    } catch (e) {
                        addTestResult({
                            test: '下拉框显示测试',
                            status: 'error',
                            details: `❌ 错误: ${e.message}`
                        });
                    }
                }, 200);
            };

            useEffect(() => {
                // 页面加载后自动运行测试
                setTimeout(runTests, 1000);
            }, []);

            return (
                <div className="debug-container">
                    <Title level={2} style={{ textAlign: 'center', color: '#667eea', marginBottom: '40px' }}>
                        🔍 英语水平选择器调试工具
                    </Title>

                    <div className="debug-section">
                        <div className="debug-title">测试用选择器</div>
                        <Select
                            className="level-selector"
                            style={{ width: '100%' }}
                            placeholder="请选择您的英语水平"
                            value={englishLevel}
                            onChange={(value) => {
                                setEnglishLevel(value);
                                addTestResult({
                                    test: '选择器交互',
                                    status: 'success',
                                    details: `✅ 成功选择: ${value}`
                                });
                            }}
                            onDropdownVisibleChange={(visible) => {
                                setIsDropdownOpen(visible);
                                addTestResult({
                                    test: '下拉框状态变化',
                                    status: 'success',
                                    details: `✅ 下拉框${visible ? '打开' : '关闭'}`
                                });
                            }}
                            size="large"
                        >
                            {levelOptions.map(option => (
                                <Option key={option.value} value={option.value}>
                                    <div>
                                        <div style={{ fontWeight: '600' }}>{option.label}</div>
                                        <div style={{ fontSize: '12px', color: '#718096' }}>{option.description}</div>
                                    </div>
                                </Option>
                            ))}
                        </Select>
                        
                        <div style={{ marginTop: '16px' }}>
                            <Text strong>当前选择: </Text>
                            <Text>{englishLevel || '无'}</Text>
                            <br />
                            <Text strong>下拉框状态: </Text>
                            <Text>{isDropdownOpen ? '打开' : '关闭'}</Text>
                        </div>
                    </div>

                    <div className="debug-section">
                        <div className="debug-title">控制面板</div>
                        <Space>
                            <Button type="primary" onClick={runTests}>
                                🔄 重新运行测试
                            </Button>
                            <Button onClick={() => setTestResults([])}>
                                🗑️ 清空结果
                            </Button>
                            <Button 
                                onClick={() => {
                                    const selector = document.querySelector('.ant-select-selector');
                                    if (selector) selector.click();
                                }}
                            >
                                👆 手动点击选择器
                            </Button>
                        </Space>
                    </div>

                    <div className="debug-section">
                        <div className="debug-title">测试结果</div>
                        {testResults.length === 0 ? (
                            <Text type="secondary">等待测试结果...</Text>
                        ) : (
                            testResults.map((result, index) => (
                                <div 
                                    key={index}
                                    className={`test-result ${result.status === 'success' ? 'test-success' : 'test-error'}`}
                                >
                                    <strong>[{result.time}] {result.test}:</strong> {result.details}
                                </div>
                            ))
                        )}
                    </div>

                    <div className="debug-section">
                        <div className="debug-title">系统信息</div>
                        <Row gutter={[16, 16]}>
                            <Col span={12}>
                                <Text strong>浏览器: </Text>
                                <Text>{navigator.userAgent.split(' ')[0]}</Text>
                            </Col>
                            <Col span={12}>
                                <Text strong>屏幕尺寸: </Text>
                                <Text>{window.screen.width} x {window.screen.height}</Text>
                            </Col>
                            <Col span={12}>
                                <Text strong>窗口尺寸: </Text>
                                <Text>{window.innerWidth} x {window.innerHeight}</Text>
                            </Col>
                            <Col span={12}>
                                <Text strong>Ant Design: </Text>
                                <Text>v5.26.5 (CDN)</Text>
                            </Col>
                        </Row>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<DebugApp />, document.getElementById('root'));
    </script>
</body>
</html> 